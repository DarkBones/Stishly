<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => { :role => 'form'}) do |f| %>
  <div class="container">
    <div class="row">
      <div class="col-12 py-2">
        <h3>Sign up</h3>
      </div>
    </div>

    <% if devise_error_messages!.length > 0 %>
      <div class="row">
        <div class="col-12 py-2">
          <%= devise_error_messages! %>
        </div>
      </div>
    <% end %>

    <div class="row">
      <div class="col-12 col-sm-6 py-2">
        <%= f.label :first_name %>
        <%= f.text_field :first_name, :autofocus => true, class: "form-control" %>
      </div>
      <div class="col-12 col-sm-6 py-2">
        <%= f.label :last_name %>
        <%= f.text_field :last_name, class: "form-control" %>
      </div>
    </div>

    <div class="row">
      <div class="col-12 py-2">
        <%= f.label :email %>
        <%= f.email_field :email, class: "form-control" %>
      </div>
    </div>

    <div class="row">
      <div class="col-12 py-2" style="margin-bottom: -16px;">
        <%= f.label :password %>
        <%= f.password_field :password, class: 'form-control' %>
      </div>
    </div>

    <div class="row">
      <div class="col-12 py-2" style="margin-top: 0;">
        <meter max="4" id="password-strength-meter">
        </meter>
        <p>
          <strong>
            Password strength: <span id="password-strength-score"></span><br />
            <span id="password-strength-warning"></span>
          </strong>
        </p>
      </div>
    </div>

    <div class="row">
      <div class="col-12 py-2">
        <%= f.label :password_confirmation %>
        <%= f.password_field :password_confirmation, class: 'form-control' %>
      </div>
    </div>

    <%= f.hidden_field :timezone, id: 'timezone_input' %>

    <div class="row">
      <div class="col-12 py-2">
        <%= f.submit 'Sign up', :class => 'btn btn-primary' %>
      </div>
    </div>

  </div>
<% end %>

<script>
  var strength = {
    0: "Worst",
    1: "Bad",
    2: "Weak",
    3: "Good",
    4: "Strong"
  }

  var password = $("#user_password");
  var meter = $("#password-strength-meter");

  password.on("keyup", function(){
    var val = password.val();
    var result = zxcvbn(val);

    meter.val(result.score);

    $("#password-strength-score").text(strength[result.score]);
    $("#password-strength-warning").text(result.feedback.warning);


  });

</script>