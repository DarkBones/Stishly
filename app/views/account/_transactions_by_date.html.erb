<%= render "transactions_list", locals: locals %>

<% dates = distinct_dates(locals[:transactions]) %>
<% dates.each do |d| %>
  <% d_formatted = d.strftime("%d %b %Y") %>
  <script type="text/javascript">
    if ($("#" + "<%= d %>").length > 0) {
      $("#" + "<%= d %> ul").append("<%= j yield d %>");
    } else {
      $("#transactions").append(
        "<div id=\"<%= d %>\">" +
        "<h3 id=\"day_<%= d %>\"><%= d_formatted %><span class=\"float-right\">" +
        "<%= balance(locals[:daily_totals][d], locals[:account_currency]) %>" + "</span></h3>" +
        "<ul id=\"transactions_<%= d %>\">" +
        "<%= j yield d %>" +
        "</ul>" +
        "</div>"
        )
    }
  </script>
<% end %>
